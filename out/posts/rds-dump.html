<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/9674fbd74573baf2.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/9c260706f7fe78ad.css" data-precedence="next"/><link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=G-Q587R5F0YL"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><style data-emotion="css 11u4k1p">.css-11u4k1p{height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><body class="MuiBox-root css-11u4k1p"><style data-emotion="css 1rl0808">.css-1rl0808{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;height:10%;}</style><header class="MuiBox-root css-1rl0808"><a href="/"><style data-emotion="css rvp98e">.css-rvp98e{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem;}</style><div class="MuiBox-root css-rvp98e"><style data-emotion="css 7us9jm">.css-7us9jm{position:relative;aspect-ratio:1;width:2.5rem;}</style><div class="MuiBox-root css-7us9jm"><img alt="icon of codeverse" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/assets/images/codeverse_icon.png"/></div><style data-emotion="css 1lqa4xe">.css-1lqa4xe{margin:0;font-size:2rem;font-weight:bold;font-family:Pretendard,Arial,sans-serif;line-height:1.167;}</style><h1 class="MuiTypography-root MuiTypography-h1 css-1lqa4xe">Codeverse</h1></div></a></header><style data-emotion="css ysfit3">.css-ysfit3{height:90%;width:900px;margin-left:auto;margin-right:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><main class="MuiBox-root css-ysfit3"><style data-emotion="css 1hcqf0i">.css-1hcqf0i{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;width:100%;}</style><nav class="MuiBox-root css-1hcqf0i"><style data-emotion="css 17nvzqb">.css-17nvzqb{list-style:none;margin:0;padding:0;position:relative;padding-top:8px;padding-bottom:8px;padding-left:40px;padding-right:40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-around;-ms-flex-pack:space-around;-webkit-justify-content:space-around;justify-content:space-around;}</style><ul class="MuiList-root MuiList-padding css-17nvzqb"><a href="/posts"><style data-emotion="css kkkt2y">.css-kkkt2y{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;-webkit-text-decoration:none;text-decoration:none;width:100%;box-sizing:border-box;text-align:left;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;width:100%;height:100%;}</style><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-kkkt2y"><style data-emotion="css 16nk4yl">.css-16nk4yl{margin:0;font-size:1.25rem;font-weight:bold;font-family:Pretendard,Arial,sans-serif;line-height:1.75;}</style><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">Posts</h6></li></a><a href="/tags"><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-kkkt2y"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">Tags</h6></li></a><a href="/about"><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-kkkt2y"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">About Me</h6></li></a></ul></nav><style data-emotion="css xdees7">.css-xdees7{overflow:scroll;}</style><section class="MuiBox-root css-xdees7"><div><style data-emotion="css 79elbk">.css-79elbk{position:relative;}</style><article class="MuiBox-root css-79elbk"><style data-emotion="css 1yn3bhb">.css-1yn3bhb{font-weight:700;text-align:center;padding:40px;max-height:24rem;min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content;-webkit-transition:all 0.3s;transition:all 0.3s;position:relative;}</style><div class="MuiBox-root css-1yn3bhb"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">AWS RDS의 Data base를 dump하기</h6><style data-emotion="css e88rns">.css-e88rns{margin:0;font-size:0.875rem;font-family:Pretendard,Arial,sans-serif;font-weight:400;line-height:1.43;color:#666;text-align:right;font-style:italic;}</style><p class="MuiTypography-root MuiTypography-body2 css-e88rns">- <!-- -->2021/09/14</p></div><style data-emotion="css lv7w6x">.css-lv7w6x{box-sizing:border-box;width:100%;padding:32px;}</style><div class="MuiBox-root css-lv7w6x"><style data-emotion="css mpuzfv">.css-mpuzfv{margin:0;font-size:1rem;font-family:Pretendard,Arial,sans-serif;font-weight:400;line-height:1.5;color:#0288d1;}</style><p class="MuiTypography-root MuiTypography-body1 css-mpuzfv"><style data-emotion="css 10vyf6v">.css-10vyf6v{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-10vyf6v" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="FormatQuoteIcon"><path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"></path></svg>VPC 안에 있는 RDS에서 Data base를 dump해 와서 local의 mysql에 밀어 넣는 과정에서 단편적으로 맞닥뜨렸던 문제를 기록합니다.</p></div><style data-emotion="css 1b3tymb">.css-1b3tymb{width:90%;margin:auto;display:block;}</style><img class="MuiBox-root css-1b3tymb" src="/assets/images/posts/rds-dump.png" alt="thumbnail" loading="lazy"/><style data-emotion="css 1qm1lh">.css-1qm1lh{margin-bottom:16px;}</style><div class="markdown-body post MuiBox-root css-1qm1lh"><h2 id="ssh-tunneling을-통해-db-dump해오기" class="heading">ssh tunneling을 통해 DB dump해오기</h2>
<ul>
<li><code>mysqldump</code> 명령어를 통해 <code>.sql</code>파일의 형태로 db를 덤프해 올 수 있습니다.</li>
<li>tunneling을 수행할 ec2 인스턴스가 mysql client를 가지고 있어야 합니다.</li>
</ul>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line">$ <span class="token function">ssh</span> <span class="token variable"><span class="token variable">`</span>tunneling-instanse-username<span class="token variable">`</span></span>@<span class="token variable"><span class="token variable">`</span>tunneling-instanse-host<span class="token variable">`</span></span> <span class="token parameter variable">-i</span> <span class="token variable"><span class="token variable">`</span>key-file-path<span class="token variable">`</span></span> mysqldump -u<span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span> -p<span class="token variable"><span class="token variable">`</span>password<span class="token variable">`</span></span> <span class="token parameter variable">-h</span> <span class="token variable"><span class="token variable">`</span>remote-db-host<span class="token variable">`</span></span> <span class="token variable"><span class="token variable">`</span>database-name<span class="token variable">`</span></span> <span class="token operator">></span> <span class="token variable"><span class="token variable">`</span>local/path/to/save.sql<span class="token variable">`</span></span>
</span></code></pre>
<h3 id="column_statistics">COLUMN_STATISTICS</h3>
<h4 id="덤프-시도-중--unknown-table-column_statistics-in-information_schema-라는-에러가-발생할-경우">덤프 시도 중 <code>...: Unknown table 'COLUMN_STATISTICS' in information_schema</code> 라는 에러가 발생할 경우</h4>
<ul>
<li>8.0부터 새로 추가된 옵션으로, 덤프 할 때 ANALYZE TABLE에 통계 데이터를 입력 또는 수정하는 옵션이라고 합니다.<sup><a href="https://jay-ji.tistory.com/62" target="_blank" rel="noopener noreferer">레퍼런스</a></sup></li>
<li>명시적으로 해당 옵션을 사용하지 않는다고 알려줍시다. dump 명령에 <code>--column-statistics=0</code> 옵션을 추가합니다.</li>
</ul>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line">$ <span class="token function">ssh</span> <span class="token variable"><span class="token variable">`</span>tunneling-instanse-username<span class="token variable">`</span></span>@<span class="token variable"><span class="token variable">`</span>tunneling-instanse-host<span class="token variable">`</span></span> <span class="token parameter variable">-i</span> <span class="token variable"><span class="token variable">`</span>key-file-path<span class="token variable">`</span></span> mysqldump -u<span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span> -p<span class="token variable"><span class="token variable">`</span>password<span class="token variable">`</span></span> <span class="token parameter variable">-h</span> <span class="token variable"><span class="token variable">`</span>remote-db-host<span class="token variable">`</span></span> --column-statistics<span class="token operator">=</span><span class="token number">0</span> <span class="token variable"><span class="token variable">`</span>database-name<span class="token variable">`</span></span> <span class="token operator">></span> <span class="token variable"><span class="token variable">`</span>local/path/to/save.sql<span class="token variable">`</span></span>
</span></code></pre>
<h4 id="덤프-시도-중-unknown-variable-column-statistics0-라는-에러가-발생할-경우">덤프 시도 중 <code>...unknown variable 'column-statistics=0'...</code> 라는 에러가 발생할 경우</h4>
<ul>
<li>위의 문제에 해당하지 않는 데 옵션을 주는 경우로, dump 명령 옵션에서 <code>--column-statistics=0</code>을 제거합니다.</li>
</ul>
<h2 id="sql파일을-로컬-mysql에-로드하기" class="heading">.sql파일을 로컬 mysql에 로드하기</h2>
<ul>
<li><code>mysql</code>명령어를 통해 <code>database-name</code>이라는 data base 에 <code>dumped.sql</code> 파일의 내용을 로드할 수 있습니다.</li>
<li>데이터를 받을 database는 미리 생성되어있고 비어있어야 합니다.</li>
</ul>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line">$ mysql -u<span class="token variable"><span class="token variable">`</span>local-user-name<span class="token variable">`</span></span> -p<span class="token variable"><span class="token variable">`</span>local-pwd<span class="token variable">`</span></span> <span class="token variable"><span class="token variable">`</span>database-name<span class="token variable">`</span></span> <span class="token operator">&#x3C;</span> <span class="token variable"><span class="token variable">`</span>path/for/dumped.sql<span class="token variable">`</span></span>
</span></code></pre>
<h3 id="no_auto_create_user">NO_AUTO_CREATE_USER</h3>
<h4 id="로드-시도-중-variable-sql_mode-cant-be-set-to-the-value-of-no_auto_create_user-라는-에러가-발생할-경우">로드 시도 중 <code>Variable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'</code> 라는 에러가 발생할 경우</h4>
<ul>
<li>USER 생성과 관련있는 모드입니다. mysql 8.0 이상부터 해당 모드가 제거되고 별도 구문으로(<code>CREAT USER...</code> 또는 <code>GRANT...</code> ) 처리됩니다.</li>
<li>해결을 위해 <code>dumped.sql</code> 의 내용을 약간 수정해줍니다.</li>
<li><code>.sql</code>파일은 데이터 베이스를 구성하는 sql문이 잔뜩 적혀있어 용량이 매우 큰 경우가 대부분입니다. 따라서 editor으로 열어서 수정하는 것은 좋지 않은 선택입니다. <code>sed</code> 명령어를 사용해 수정합니다.</li>
<li><code>sed</code>명령어는 레퍼런스가 많지만, Unix 계열인 mac의 터미널에서는 용법이 조금 다릅니다.</li>
</ul>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">''</span> <span class="token string">'s/NO_AUTO_CREATE_USER//'</span> <span class="token variable"><span class="token variable">`</span>path/for/dumped.sql<span class="token variable">`</span></span>
</span></code></pre>
<ul>
<li>위와 같이 입력하여 sql파일을 수정하고 다시 로드합니다.</li>
</ul></div></article></div></section></main><!--$!--><template data-dgst="NEXT_DYNAMIC_NO_SSR_CODE"></template><!--/$--><script src="/_next/static/chunks/webpack-6c88f117227a55df.js" async=""></script><script src="/_next/static/chunks/2443530c-b37977cb0d35fe50.js" async=""></script><script src="/_next/static/chunks/488-754b8491efac4835.js" async=""></script><script src="/_next/static/chunks/main-app-98d28d7655df5891.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/9674fbd74573baf2.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/9c260706f7fe78ad.css\",{\"as\":\"style\"}]\n"])</script><script>self.__next_f.push([1,"4:I{\"id\":\"8827\",\"chunks\":[\"272:static/chunks/webpack-6c88f117227a55df.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":\"9126\",\"chunks\":[\"272:static/chunks/webpack-6c88f117227a55df.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":\"1616\",\"chunks\":[\"771:static/chunks/771-a273996dc83f4cad.js\",\"274:static/chunks/274-31a5843dc341abd2.js\",\"964:static/"])</script><script>self.__next_f.push([1,"chunks/964-3fbb84800944960d.js\",\"925:static/chunks/925-98b9640d621f887a.js\",\"222:static/chunks/222-8be30348cbe4dffe.js\",\"185:static/chunks/app/layout-6cdfa5accf696248.js\"],\"name\":\"\",\"async\":false}\n9:I{\"id\":\"4463\",\"chunks\":[\"272:static/chunks/webpack-6c88f117227a55df.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":\"1010\",\"chunks\":[\"272:static/chunks/webpack-6c88f117227a55df.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\""])</script><script>self.__next_f.push([1,",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9674fbd74573baf2.css\",\"precedence\":\"next\"}]],[\"$\",\"$L4\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/rds-dump\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"rds-dump\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"rds-dump\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L5\",null],\"globalErrorComponent\":\"$6\",\"notFound\":[\"$\",\"$L7\",null,{\"params\":{},\"children\":[\"$L8\",\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}],\"asNotFound\":false,\"children\":[[\"$\",\"$L7\",null,{\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[[null,[\"$\",\"div\",null,{\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"slug\",\"rds-dump\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lb\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"rds-dump\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9c260706f7fe78ad.css\",\"precedence\":\"next\"}]]}]}]],null],\"segment\":[\"slug\",\"rds-dump\",\"d\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}],\"params\":{}}],null]}]]\n"])</script><script>self.__next_f.push([1,"c:I{\"id\":\"3677\",\"chunks\":[\"771:static/chunks/771-a273996dc83f4cad.js\",\"964:static/chunks/964-3fbb84800944960d.js\",\"333:static/chunks/app/posts/[slug]/page-d8961a30f5fcaed8.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"b:[null,[\"$\",\"$Lc\",null,{\"post\":{\"slug\":\"rds-dump\",\"meta\":{\"title\":\"AWS RDS의 Data base를 dump하기\",\"description\":\"VPC 안에 있는 RDS에서 Data base를 dump해 와서 local의 mysql에 밀어 넣는 과정에서 단편적으로 맞닥뜨렸던 문제를 기록합니다.\",\"date\":\"2021/09/14\",\"tags\":[\"COLUMN_STATISTICS\",\"NO_AUTO_CREATE_USER\",\"column-statistics=0\",\"mysqldump\",\"sed\",\"sql_mode\",\"ssh tunneling\"],\"thumbnail\":\"assets/images/posts/rds-dump.png\"},\"content\":\"\\n## ssh tunneling을 통해 DB dump해오기\\n\\n- `mysqldump` 명령어를 통해 `.sql`파일의 형태로 db를 덤프해 올 수 있습니다.\\n- tunneling을 수행할 ec2 인스턴스가 mysql client를 가지고 있어야 합니다.\\n\\n```shell\\n$ ssh `tunneling-instanse-username`@`tunneling-instanse-host` -i `key-file-path` mysqldump -u`username` -p`password` -h `remote-db-host` `database-name` \u003e `local/path/to/save.sql`\\n```\\n\\n### COLUMN_STATISTICS\\n\\n#### 덤프 시도 중 `...: Unknown table 'COLUMN_STATISTICS' in information_schema` 라는 에러가 발생할 경우\\n\\n- 8.0부터 새로 추가된 옵션으로, 덤프 할 때 ANALYZE TABLE에 통계 데이터를 입력 또는 수정하는 옵션이라고 합니다.\u003csup\u003e[레퍼런스](https://jay-ji.tistory.com/62)\u003c/sup\u003e\\n- 명시적으로 해당 옵션을 사용하지 않는다고 알려줍시다. dump 명령에 `--column-statistics=0` 옵션을 추가합니다.\\n\\n```shell\\n$ ssh `tunneling-instanse-username`@`tunneling-instanse-host` -i `key-file-path` mysqldump -u`username` -p`password` -h `remote-db-host` --column-statistics=0 `database-name` \u003e `local/path/to/save.sql`\\n```\\n\\n#### 덤프 시도 중 `...unknown variable 'column-statistics=0'...` 라는 에러가 발생할 경우\\n\\n- 위의 문제에 해당하지 않는 데 옵션을 주는 경우로, dump 명령 옵션에서 `--column-statistics=0`을 제거합니다.\\n\\n## .sql파일을 로컬 mysql에 로드하기\\n\\n- `mysql`명령어를 통해 `database-name`이라는 data base 에 `dumped.sql` 파일의 내용을 로드할 수 있습니다.\\n- 데이터를 받을 database는 미리 생성되어있고 비어있어야 합니다.\\n\\n```shell\\n$ mysql -u`local-user-name` -p`local-pwd` `database-name` \u003c `path/for/dumped.sql`\\n```\\n\\n### NO_AUTO_CREATE_USER\\n\\n#### 로드 시도 중 `Variable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'` 라는 에러가 발생할 경우\\n\\n- USER 생성과 관련있는 모드입니다. mysql 8.0 이상부터 해당 모드가 제거되고 별도 구문으로(`CREAT USER...` 또는 `GRANT...` ) 처리됩니다.\\n- 해결을 위해 `dumped.sql` 의 내용을 약간 수정해줍니다.\\n- `.sql`파일은 데이터 베이스를 구성하는 sql문이 잔뜩 적혀있어 용량이 매우 큰 경우가 대부분입니다. 따라서 editor으로 열어서 수정하는 것은 좋지 않은 선택입니다. `sed` 명령어를 사용해 수정합니다.\\n- `sed`명령어는 레퍼런스가 많지만, Unix 계열인 mac의 터미널에서는 용법이 조금 다릅니다.\\n\\n```shell\\nsed -i '' 's/NO_AUTO_CREATE_USER//' `path/for/dumped.sql`\\n```\\n\\n- 위와 같이 입력하여 sql파일을 수정하고 다시 로드합니다.\\n\"},\"meta\":{\"title\":\"AWS RDS의 Data base를 dump하기\",\"description\":\"VPC 안에 있는 RDS에서 Data base를 dump해 와서 local의 mysql에 밀어 넣는 과정에서 단편적으로 맞닥뜨렸던 문제를 기록합니다.\",\"date\":\"2021/09/14\",\"tags\":[\"COLUMN_STATISTICS\",\"NO_AUTO_CREATE_USER\",\"column-statistics=0\",\"mysqldump\",\"sed\",\"sql_mode\",\"ssh tunneling\"],\"thumbnail\":\"assets/images/posts/rds-dump.png\"},\"content\":\"\u003ch2 id=\\\"ssh-tunneling을-통해-db-dump해오기\\\" class=\\\"heading\\\"\u003essh tunneling을 통해 DB dump해오기\u003c/h2\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ccode\u003emysqldump\u003c/code\u003e 명령어를 통해 \u003ccode\u003e.sql\u003c/code\u003e파일의 형태로 db를 덤프해 올 수 있습니다.\u003c/li\u003e\\n\u003cli\u003etunneling을 수행할 ec2 인스턴스가 mysql client를 가지고 있어야 합니다.\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre class=\\\"language-shell\\\"\u003e\u003ccode class=\\\"language-shell code-highlight\\\"\u003e\u003cspan class=\\\"code-line\\\"\u003e$ \u003cspan class=\\\"token function\\\"\u003essh\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003etunneling-instanse-username\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e@\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003etunneling-instanse-host\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token parameter variable\\\"\u003e-i\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003ekey-file-path\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e mysqldump -u\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003eusername\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e -p\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003epassword\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token parameter variable\\\"\u003e-h\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003eremote-db-host\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003edatabase-name\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e\u003e\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003elocal/path/to/save.sql\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e\\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003ch3 id=\\\"column_statistics\\\"\u003eCOLUMN_STATISTICS\u003c/h3\u003e\\n\u003ch4 id=\\\"덤프-시도-중--unknown-table-column_statistics-in-information_schema-라는-에러가-발생할-경우\\\"\u003e덤프 시도 중 \u003ccode\u003e...: Unknown table 'COLUMN_STATISTICS' in information_schema\u003c/code\u003e 라는 에러가 발생할 경우\u003c/h4\u003e\\n\u003cul\u003e\\n\u003cli\u003e8.0부터 새로 추가된 옵션으로, 덤프 할 때 ANALYZE TABLE에 통계 데이터를 입력 또는 수정하는 옵션이라고 합니다.\u003csup\u003e\u003ca href=\\\"https://jay-ji.tistory.com/62\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferer\\\"\u003e레퍼런스\u003c/a\u003e\u003c/sup\u003e\u003c/li\u003e\\n\u003cli\u003e명시적으로 해당 옵션을 사용하지 않는다고 알려줍시다. dump 명령에 \u003ccode\u003e--column-statistics=0\u003c/code\u003e 옵션을 추가합니다.\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre class=\\\"language-shell\\\"\u003e\u003ccode class=\\\"language-shell code-highlight\\\"\u003e\u003cspan class=\\\"code-line\\\"\u003e$ \u003cspan class=\\\"token function\\\"\u003essh\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003etunneling-instanse-username\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e@\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003etunneling-instanse-host\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token parameter variable\\\"\u003e-i\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003ekey-file-path\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e mysqldump -u\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003eusername\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e -p\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003epassword\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token parameter variable\\\"\u003e-h\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003eremote-db-host\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e --column-statistics\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e0\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003edatabase-name\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e\u003e\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003elocal/path/to/save.sql\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e\\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003ch4 id=\\\"덤프-시도-중-unknown-variable-column-statistics0-라는-에러가-발생할-경우\\\"\u003e덤프 시도 중 \u003ccode\u003e...unknown variable 'column-statistics=0'...\u003c/code\u003e 라는 에러가 발생할 경우\u003c/h4\u003e\\n\u003cul\u003e\\n\u003cli\u003e위의 문제에 해당하지 않는 데 옵션을 주는 경우로, dump 명령 옵션에서 \u003ccode\u003e--column-statistics=0\u003c/code\u003e을 제거합니다.\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003ch2 id=\\\"sql파일을-로컬-mysql에-로드하기\\\" class=\\\"heading\\\"\u003e.sql파일을 로컬 mysql에 로드하기\u003c/h2\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ccode\u003emysql\u003c/code\u003e명령어를 통해 \u003ccode\u003edatabase-name\u003c/code\u003e이라는 data base 에 \u003ccode\u003edumped.sql\u003c/code\u003e 파일의 내용을 로드할 수 있습니다.\u003c/li\u003e\\n\u003cli\u003e데이터를 받을 database는 미리 생성되어있고 비어있어야 합니다.\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre class=\\\"language-shell\\\"\u003e\u003ccode class=\\\"language-shell code-highlight\\\"\u003e\u003cspan class=\\\"code-line\\\"\u003e$ mysql -u\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003elocal-user-name\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e -p\u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003elocal-pwd\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003edatabase-name\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003epath/for/dumped.sql\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e\\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003ch3 id=\\\"no_auto_create_user\\\"\u003eNO_AUTO_CREATE_USER\u003c/h3\u003e\\n\u003ch4 id=\\\"로드-시도-중-variable-sql_mode-cant-be-set-to-the-value-of-no_auto_create_user-라는-에러가-발생할-경우\\\"\u003e로드 시도 중 \u003ccode\u003eVariable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'\u003c/code\u003e 라는 에러가 발생할 경우\u003c/h4\u003e\\n\u003cul\u003e\\n\u003cli\u003eUSER 생성과 관련있는 모드입니다. mysql 8.0 이상부터 해당 모드가 제거되고 별도 구문으로(\u003ccode\u003eCREAT USER...\u003c/code\u003e 또는 \u003ccode\u003eGRANT...\u003c/code\u003e ) 처리됩니다.\u003c/li\u003e\\n\u003cli\u003e해결을 위해 \u003ccode\u003edumped.sql\u003c/code\u003e 의 내용을 약간 수정해줍니다.\u003c/li\u003e\\n\u003cli\u003e\u003ccode\u003e.sql\u003c/code\u003e파일은 데이터 베이스를 구성하는 sql문이 잔뜩 적혀있어 용량이 매우 큰 경우가 대부분입니다. 따라서 editor으로 열어서 수정하는 것은 좋지 않은 선택입니다. \u003ccode\u003esed\u003c/code\u003e 명령어를 사용해 수정합니다.\u003c/li\u003e\\n\u003cli\u003e\u003ccode\u003esed\u003c/code\u003e명령어는 레퍼런스가 많지만, Unix 계열인 mac의 터미널에서는 용법이 조금 다릅니다.\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cpre class=\\\"language-shell\\\"\u003e\u003ccode class=\\\"language-shell code-highlight\\\"\u003e\u003cspan class=\\\"code-line\\\"\u003e\u003cspan class=\\\"token function\\\"\u003esed\u003c/span\u003e \u003cspan class=\\\"token parameter variable\\\"\u003e-i\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e''\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e's/NO_AUTO_CREATE_USER//'\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003epath/for/dumped.sql\u003cspan class=\\\"token variable\\\"\u003e`\u003c/span\u003e\u003c/span\u003e\\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cul\u003e\\n\u003cli\u003e위와 같이 입력하여 sql파일을 수정하고 다시 로드합니다.\u003c/li\u003e\\n\u003c/ul\u003e\"}]]\n"])</script><script>self.__next_f.push([1,"8:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],null,null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,null]\n5:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],null,null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,nu"])</script><script>self.__next_f.push([1,"ll,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]],[],null]]\n"])</script></body></html>
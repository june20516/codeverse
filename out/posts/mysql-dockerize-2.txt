1:HL["/_next/static/css/e8f9a37b33730b6d.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["slug","mysql-dockerize-2","d"],{"children":["__PAGE__?{\"slug\":\"mysql-dockerize-2\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/e8f9a37b33730b6d.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/41897fdb7555a39f.css",{"as":"style"}]
5:I{"id":"1273","chunks":["920:static/chunks/920-4cc7de8e14e4b1e5.js","707:static/chunks/707-de92662865eaa972.js","185:static/chunks/app/layout-db7bd22285a3227e.js"],"name":"","async":false}
6:I{"id":"8920","chunks":["920:static/chunks/920-4cc7de8e14e4b1e5.js","605:static/chunks/app/tags/[tag]/page-80a247f5477a47db.js"],"name":"","async":false}
7:I{"id":"8707","chunks":["920:static/chunks/920-4cc7de8e14e4b1e5.js","707:static/chunks/707-de92662865eaa972.js","185:static/chunks/app/layout-db7bd22285a3227e.js"],"name":"","async":false}
8:I{"id":"4463","chunks":["272:static/chunks/webpack-4b363aefe6ea6579.js","667:static/chunks/2443530c-424cdbcd2566cb72.js","488:static/chunks/488-e94a566894f82f75.js"],"name":"","async":false}
9:I{"id":"1010","chunks":["272:static/chunks/webpack-4b363aefe6ea6579.js","667:static/chunks/2443530c-424cdbcd2566cb72.js","488:static/chunks/488-e94a566894f82f75.js"],"name":"","async":false}
b:"$Sreact.suspense"
c:I{"id":"2126","chunks":["920:static/chunks/920-4cc7de8e14e4b1e5.js","707:static/chunks/707-de92662865eaa972.js","185:static/chunks/app/layout-db7bd22285a3227e.js"],"name":"","async":false}
2:[["$","html",null,{"lang":"en","children":[null,["$","$L5",null,{"src":"https://www.googletagmanager.com/gtag/js?id=G-Q587R5F0YL"}],["$","$L5",null,{"id":"google-analytics","dangerouslySetInnerHTML":{"__html":"\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n   \n            gtag('config', 'G-Q587R5F0YL');\n          "}}],["$","body",null,{"children":[["$","header",null,{"className":"flex items-center px-8","children":["$","$L6",null,{"href":"/","className":"flex items-center","children":[["$","div",null,{"className":"relative w-10 mr-4 aspect-square","children":["$","$L7",null,{"src":"assets/images/codeverse_icon.png","fill":true,"alt":"icon of codeverse"}]}],["$","h1",null,{"className":"text-3xl font-bold","children":"Codeverse"}]]}]}],["$","aside",null,{"children":["$","ul",null,{"className":"px-5","children":[["$","li","0",{"className":"pt-4 border-b border-b-primary-900","children":["$","$L6",null,{"className":"block w-full h-fulltext-lg text-lg","href":"/posts","children":"Posts"}]}],["$","li","1",{"className":"pt-4 border-b border-b-primary-900","children":["$","$L6",null,{"className":"block w-full h-fulltext-lg text-lg","href":"/tags","children":"Tags"}]}],["$","li","2",{"className":"pt-4 border-b border-b-primary-900","children":["$","$L6",null,{"className":"block w-full h-fulltext-lg text-lg","href":"/about","children":"About Me"}]}]]}]}],["$","main",null,{"className":"overflow-auto","children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[[null,["$","div",null,{"className":"px-4","children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["slug","mysql-dockerize-2","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$La",null],"segment":"__PAGE__?{\"slug\":\"mysql-dockerize-2\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/41897fdb7555a39f.css","precedence":"next"}]]}]}]],null],"segment":["slug","mysql-dockerize-2","d"]},"styles":[]}],"segment":"posts"},"styles":[]}]}],["$","$b",null,{"fallback":null,"children":["$","$Lc",null,{}]}]]}]]}],null]
3:[[["$","meta",null,{"charSet":"utf-8"}],null,null,null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]],[],null]]
a:[null,["$","article",null,{"className":"space-y-6","children":[["$","div",null,{"className":"text-4xl font-bold text-center p-10 sticky top-0 bg-white max-h-96 min-h-fit","children":["mysql dockerize(2) - mysql container에 볼륨 설정하기",["$","p",null,{"className":"text-base text-right italic text-secondary-400","children":[" - ","2021/11/13"]}]]}],["$","div",null,{"className":"w-full bg-background-primary-100 p-4","children":["$","p",null,{"className":"font-semibold text-secondary-600","children":"내 로컬 환경은 소중하니까"}]}],["$","img",null,{"src":"/assets/images/posts/mysql-dockerize.jpeg","className":"w-[90%] mx-auto","alt":"thumbnail","loading":"lazy"}],["$","div",null,{"className":"markdown-body post","dangerouslySetInnerHTML":{"__html":"<h2 id=\"계속-쓸-수-있는-db-만들기\" class=\"heading\">계속 쓸 수 있는 DB 만들기</h2>\n<p>일반적으로 도커 컨테이너는 프로세스가 종료되면 내부에서 일어났던 변경사항들은 날아갑니다. 재부팅이라도 하는 날에는 그 동안 컨테이너에서 생성했던 데이터들은 없던 일이 되죠. 물론 도커는 볼륨이라는 개념으로 데이터를 유지할 수 있는 기능을 제공합니다.\nmysql 이미지는 이 기능을 내부적으로 사용하고 있어서, 컨테이너를 생성할 때 볼륨을 자동 생성합니다. 그래서 컨테이너를 실행하고 정지하는 것을 반복해도 데이터가 유지됩니다. 하지만 이 렇게 만들어진 볼륨은 컨테이너가 아예 삭제되어 버리는 경우 그 데이터를 보존할 수가 없습니다.\n저는 몇 번 재설치를 하더라도 데이터는 별도로 관리할 수 있었으면 좋겠어요.</p>\n<h3 id=\"볼륨\">볼륨</h3>\n<p>공식 문서에는 이렇게 쓰여있습니다.</p>\n<blockquote>\n<p>Volumes are the preferred mechanism for persisting data generated by and used by Docker containers.\nWhile bind mounts are dependent on the directory structure and OS of the host machine, volumes are completely managed by Docker.</p>\n</blockquote>\n<p>데이터를 유지하기 위한 기본 메커니즘이라고 합니다. <code>Bind mount</code>라는 운영 체제의 파일 시스템을 컨테이너에 마운트 해 쓰는 기능이 있는데, 볼륨은 그 보다 더 폭넓은 기능을 제공하고, 관리를 도커 내에서 하기 때문에 도커를 실행하는 운영체제에 영향을 받지 않는다는 장점이 있습니다.</p>\n<h3 id=\"볼륨-확인\">볼륨 확인</h3>\n<p>먼저 기본으로 생성되는 볼륨을 확인해 보겠습니다.</p>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> run <span class=\"token parameter variable\">--name</span> mysql <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token number\">1234</span> <span class=\"token parameter variable\">-d</span> mysql\n</span><span class=\"code-line\">e94b0ab7eed5b1d147147ffe5b170d1520ee680f7b3ab7511e4e0fb4fb9a1925\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">$  <span class=\"token function\">docker</span> volume list\n</span><span class=\"code-line\">DRIVER    VOLUME NAME\n</span><span class=\"code-line\"><span class=\"token builtin class-name\">local</span>     b97c5432ff0a86802d2cbca69484448f1ecd5c530ddcad7e4b7eea3c6ec2e8c5\n</span></code></pre>\n<p><code>docker volume list</code>로 볼륨의 리스트를 확인하면 임의의 해시로 설정된 볼륨이 생성된 것을 확인할 수 있습니다.\n그럼 컨테이너를 삭제하고 다시 실행해 보겠습니다.</p>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> stop mysql\n</span><span class=\"code-line\">mysql\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">$ <span class=\"token function\">docker</span> <span class=\"token function\">rm</span> mysql\n</span><span class=\"code-line\">mysql\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">$ <span class=\"token function\">docker</span> run <span class=\"token parameter variable\">--name</span> mysql <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token number\">1234</span> <span class=\"token parameter variable\">-d</span> mysql\n</span><span class=\"code-line\">456be35825bc8b1b7d2a4494c8b160ab578730f31a625a775abea271b036eae7\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">$ <span class=\"token function\">docker</span> volume list\n</span><span class=\"code-line\">DRIVER    VOLUME NAME\n</span><span class=\"code-line\"><span class=\"token builtin class-name\">local</span>     6765f342d98d3f274a0d7c3b137e07e48e9c153764e372707b6d987018498e6d\n</span><span class=\"code-line\"><span class=\"token builtin class-name\">local</span>     b97c5432ff0a86802d2cbca69484448f1ecd5c530ddcad7e4b7eea3c6ec2e8c5\n</span></code></pre>\n<p>아까 생성됐던 볼륨은 지워지지 않고 새로운 볼륨이 생성된 것을 확인할 수 있습니다. 지금은 볼륨 리스트로만 확인해봤지만 직접 컨테이너 안에 들어가서 데이터를 생성해보며 테스트를 해봐도 컨테이너를 삭제 후 생성하면 기존의 데이터가 없음을 확인할 수 있습니다.</p>\n<h3 id=\"볼륨에-이름-부여하기\">볼륨에 이름 부여하기</h3>\n<p>컨테이너를 실행할 때 <code>-v {볼륨 이름||로컬 경로}:{컨테이너 안 경로}</code>또는 <code>--volume={볼륨 이름||로컬 경로}:{컨테이너 안 경로}</code> 옵션을 부여하여 볼륨을 직접 설정할 수 있습니다. mysql 이미지 안에서 볼륨은 <code>/var/lib/mysql</code>에 마운트 되어야 하기 때문에, 해당 경로와 임의의 이름으로 옵션을 부여합니다. 아래에서는 이름을 <code>mysql-volume</code>으로 설정했습니다.</p>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> run <span class=\"token parameter variable\">--name</span> mysql <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token number\">1234</span> <span class=\"token parameter variable\">-v</span> mysql-volume:/var/lib/mysql <span class=\"token parameter variable\">-d</span> mysql\n</span></code></pre>\n<p><code>myslq-volume</code>이라는 이름의 볼륨을 <code>mysql</code>이라는 이름의 컨테이너에 쓰기로 했으니, 이제 다시 볼륨 목록을 확인해 보겠습니다.</p>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> volume list\n</span><span class=\"code-line\">DRIVER    VOLUME NAME\n</span><span class=\"code-line\"><span class=\"token builtin class-name\">local</span>     6765f342d98d3f274a0d7c3b137e07e48e9c153764e372707b6d987018498e6d\n</span><span class=\"code-line\"><span class=\"token builtin class-name\">local</span>     b97c5432ff0a86802d2cbca69484448f1ecd5c530ddcad7e4b7eea3c6ec2e8c5\n</span><span class=\"code-line\"><span class=\"token builtin class-name\">local</span>     mysql-volume\n</span></code></pre>\n<p>볼륨이 생성되었습니다. 이제 이름이 존재하는 볼륨을 사용하니까, 컨테이너를 계속 삭제해도 볼륨을 직접 제거하지 않는 한 볼륨 옵션을 명시하여 동일한 볼륨을 계속 쓸 수 있습니다.</p>\n<h3 id=\"볼륨-삭제하기\">볼륨 삭제하기</h3>\n<p>불필요한 볼륨들은 삭제합시다.</p>\n<ol>\n<li>컨테이너를 삭제할 때 같이 삭제하는 방법으로, 컨테이너 삭제 명령에 <code>-v</code>옵션을 줄 수 있습니다.</li>\n</ol>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-v</span> mysql\n</span></code></pre>\n<ol start=\"2\">\n<li>위에서 했던 것과 같이 볼륨 리스트를 보고 직접 해시네임을 선택해 삭제할 수도 있습니다.</li>\n</ol>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> volume <span class=\"token function\">rm</span> 6765f342d98d3f274a0d7c3b137e07e48e9c153764e372707b6d987018498e6d\n</span></code></pre>\n<ol start=\"3\">\n<li>로컬에 생성되어있고 컨테이너에 연결되지 않은(==dangling상태의) 모든 볼륨을 다 삭제하는 명령어도 있습니다.</li>\n</ol>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">docker</span> volume prune\n</span></code></pre>\n<hr>\n<p>시리즈의 다음 글에서는, 로컬에서 사용하던 데이터 베이스를 그대로 사용하기 위해서 dump파일을 database에 밀어넣는 방법을 알아보겠습니다.</p>"}}]]}]]

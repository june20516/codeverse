<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/9674fbd74573baf2.css" data-precedence="next"/><link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=G-Q587R5F0YL"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><style data-emotion="css 11u4k1p">.css-11u4k1p{height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><body class="MuiBox-root css-11u4k1p"><style data-emotion="css 1rl0808">.css-1rl0808{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;height:10%;}</style><header class="MuiBox-root css-1rl0808"><a href="/"><style data-emotion="css rvp98e">.css-rvp98e{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem;}</style><div class="MuiBox-root css-rvp98e"><style data-emotion="css 7us9jm">.css-7us9jm{position:relative;aspect-ratio:1;width:2.5rem;}</style><div class="MuiBox-root css-7us9jm"><img alt="icon of codeverse" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/assets/images/codeverse_icon.png"/></div><style data-emotion="css 1lqa4xe">.css-1lqa4xe{margin:0;font-size:2rem;font-weight:bold;font-family:Pretendard,Arial,sans-serif;line-height:1.167;}</style><h1 class="MuiTypography-root MuiTypography-h1 css-1lqa4xe">Codeverse</h1></div></a></header><style data-emotion="css ysfit3">.css-ysfit3{height:90%;width:900px;margin-left:auto;margin-right:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><main class="MuiBox-root css-ysfit3"><style data-emotion="css 1hcqf0i">.css-1hcqf0i{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;width:100%;}</style><nav class="MuiBox-root css-1hcqf0i"><style data-emotion="css 17nvzqb">.css-17nvzqb{list-style:none;margin:0;padding:0;position:relative;padding-top:8px;padding-bottom:8px;padding-left:40px;padding-right:40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-around;-ms-flex-pack:space-around;-webkit-justify-content:space-around;justify-content:space-around;}</style><ul class="MuiList-root MuiList-padding css-17nvzqb"><a href="/posts"><style data-emotion="css kkkt2y">.css-kkkt2y{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;-webkit-text-decoration:none;text-decoration:none;width:100%;box-sizing:border-box;text-align:left;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;width:100%;height:100%;}</style><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-kkkt2y"><style data-emotion="css 16nk4yl">.css-16nk4yl{margin:0;font-size:1.25rem;font-weight:bold;font-family:Pretendard,Arial,sans-serif;line-height:1.75;}</style><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">Posts</h6></li></a><a href="/tags"><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-kkkt2y"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">Tags</h6></li></a><a href="/about"><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-kkkt2y"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">About Me</h6></li></a></ul></nav><style data-emotion="css xdees7">.css-xdees7{overflow:scroll;}</style><section class="MuiBox-root css-xdees7"><style data-emotion="css k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="MuiBox-root css-k008qs"><style data-emotion="css 5sje0y">.css-5sje0y{padding-left:16px;padding-right:16px;margin-right:8px;border-radius:4px;background-color:whitesmoke;}</style><code class="MuiBox-root css-5sje0y"><style data-emotion="css 1h3gvvx">.css-1h3gvvx{margin:0;font-size:1rem;font-family:Pretendard,Arial,sans-serif;font-weight:400;line-height:1.5;color:#556cd6;}</style><span class="MuiTypography-root MuiTypography-body1 css-1h3gvvx">container</span></code><style data-emotion="css 1an8872">.css-1an8872{margin:0;font-size:1rem;font-family:Pretendard,Arial,sans-serif;font-weight:400;line-height:1.5;}</style><p class="MuiTypography-root MuiTypography-body1 css-1an8872">가 태그된 글 목록 -</p><style data-emotion="css 16xb11a">.css-16xb11a{margin:0;font-size:1rem;font-family:Pretendard,Arial,sans-serif;font-weight:400;line-height:1.5;color:#333;font-style:italic;padding-left:0.3125rem;padding-right:0.3125rem;}</style><p class="MuiTypography-root MuiTypography-body1 css-16xb11a">2</p><p class="MuiTypography-root MuiTypography-body1 css-1an8872">개</p></div><ol><a href="posts/mysql-dockerize-2"><style data-emotion="css zq75g5">.css-zq75g5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;-webkit-text-decoration:none;text-decoration:none;width:100%;box-sizing:border-box;text-align:left;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;width:100%;margin-top:32px;border-bottom:1px dashed;border-color:lightgray;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding-left:40px;padding-right:40px;}</style><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-zq75g5"><style data-emotion="css kt2601">.css-kt2601{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:24px;margin-bottom:24px;padding-bottom:16px;gap:8px;}</style><div class="MuiBox-root css-kt2601"><style data-emotion="css j7qwjs">.css-j7qwjs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="MuiBox-root css-j7qwjs"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">mysql dockerize(2) - mysql container에 볼륨 설정하기</h6><style data-emotion="css 1lvhjr2">.css-1lvhjr2{margin:0;font-size:1.25rem;font-family:Pretendard,Arial,sans-serif;font-weight:500;line-height:1.57;color:#666;}</style><h6 class="MuiTypography-root MuiTypography-subtitle2 css-1lvhjr2">내 로컬 환경은 소중하니까</h6></div><style data-emotion="css omtwcw">.css-omtwcw{margin:0;font-size:1.25rem;font-family:Pretendard,Arial,sans-serif;font-weight:500;line-height:1.57;color:#666;font-style:italic;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:start;justify-content:start;}</style><h6 class="MuiTypography-root MuiTypography-subtitle2 css-omtwcw">2021/11/13</h6></div></li></a><a href="posts/mysql-dockerize"><li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding css-zq75g5"><div class="MuiBox-root css-kt2601"><div class="MuiBox-root css-j7qwjs"><h6 class="MuiTypography-root MuiTypography-subtitle1 css-16nk4yl">mysql dockerize(1) - 도커로 mysql container 띄우기</h6><h6 class="MuiTypography-root MuiTypography-subtitle2 css-1lvhjr2">내 로컬 환경은 소중하니까</h6></div><h6 class="MuiTypography-root MuiTypography-subtitle2 css-omtwcw">2021/11/07</h6></div></li></a></ol></section></main><!--$!--><template data-dgst="NEXT_DYNAMIC_NO_SSR_CODE"></template><!--/$--><script src="/_next/static/chunks/webpack-300c82a1a1405294.js" async=""></script><script src="/_next/static/chunks/2443530c-b37977cb0d35fe50.js" async=""></script><script src="/_next/static/chunks/488-754b8491efac4835.js" async=""></script><script src="/_next/static/chunks/main-app-98d28d7655df5891.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/9674fbd74573baf2.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I{\"id\":\"8827\",\"chunks\":[\"272:static/chunks/webpack-300c82a1a1405294.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\n5:I{\"id\":\"9126\",\"chunks\":[\"272:static/chunks/webpack-300c82a1a1405294.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":\"1616\",\"chunks\":[\"771:static/chunks/771-b8a669428e8b47ba.js\",\"274:static/chunks/274-31a5843dc341abd2.js\",\"964:static/"])</script><script>self.__next_f.push([1,"chunks/964-3fbb84800944960d.js\",\"925:static/chunks/925-98b9640d621f887a.js\",\"222:static/chunks/222-8be30348cbe4dffe.js\",\"185:static/chunks/app/layout-6cdfa5accf696248.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":\"4463\",\"chunks\":[\"272:static/chunks/webpack-300c82a1a1405294.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\n9:I{\"id\":\"1010\",\"chunks\":[\"272:static/chunks/webpack-300c82a1a1405294.js\",\"667:static/chunks/2443530c-b37977cb0d35fe50.js\""])</script><script>self.__next_f.push([1,",\"488:static/chunks/488-754b8491efac4835.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":\"5568\",\"chunks\":[\"771:static/chunks/771-b8a669428e8b47ba.js\",\"274:static/chunks/274-31a5843dc341abd2.js\",\"640:static/chunks/640-89e60937cc8073ce.js\",\"605:static/chunks/app/tags/[tag]/page-069ad643612ff32a.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":\"6640\",\"chunks\":[\"771:static/chunks/771-b8a669428e8b47ba.js\",\"274:static/chunks/274-31a5843dc341abd2.js\",\"640:static/chunks/640-89e60937cc8073ce.js\",\"605:static/chunks/app/tags/[tag]/page-"])</script><script>self.__next_f.push([1,"069ad643612ff32a.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9674fbd74573baf2.css\",\"precedence\":\"next\"}]],[\"$\",\"$L3\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/tags/container\",\"initialTree\":[\"\",{\"children\":[\"tags\",{\"children\":[[\"tag\",\"container\",\"d\"],{\"children\":[\"__PAGE__?{\\\"tag\\\":\\\"container\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L4\",null],\"globalErrorComponent\":\"$5\",\"notFound\":[\"$\",\"$L6\",null,{\"params\":{},\"children\":[\"$L7\",\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}],\"asNotFound\":false,\"children\":[[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"tags\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"tags\",\"children\",[\"tag\",\"container\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[[[\"$\",\"$La\",null,{\"tag\":\"container\",\"count\":2}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"$Lb\",\"0\",{\"post\":{\"slug\":\"mysql-dockerize-2\",\"meta\":{\"title\":\"mysql dockerize(2) - mysql container에 볼륨 설정하기\",\"date\":\"2021/11/13\",\"description\":\"내 로컬 환경은 소중하니까\",\"thumbnail\":\"assets/images/posts/mysql-dockerize.jpeg\",\"tags\":[\"container\",\"docker\",\"mysql\",\"volume\",\"도커\",\"볼륨\"]},\"content\":\"\\n## 계속 쓸 수 있는 DB 만들기\\n\\n일반적으로 도커 컨테이너는 프로세스가 종료되면 내부에서 일어났던 변경사항들은 날아갑니다. 재부팅이라도 하는 날에는 그 동안 컨테이너에서 생성했던 데이터들은 없던 일이 되죠. 물론 도커는 볼륨이라는 개념으로 데이터를 유지할 수 있는 기능을 제공합니다.\\nmysql 이미지는 이 기능을 내부적으로 사용하고 있어서, 컨테이너를 생성할 때 볼륨을 자동 생성합니다. 그래서 컨테이너를 실행하고 정지하는 것을 반복해도 데이터가 유지됩니다. 하지만 이 렇게 만들어진 볼륨은 컨테이너가 아예 삭제되어 버리는 경우 그 데이터를 보존할 수가 없습니다.\\n저는 몇 번 재설치를 하더라도 데이터는 별도로 관리할 수 있었으면 좋겠어요.\\n\\n### 볼륨\\n\\n공식 문서에는 이렇게 쓰여있습니다.\\n\\n\u003e Volumes are the preferred mechanism for persisting data generated by and used by Docker containers.\\n\u003e While bind mounts are dependent on the directory structure and OS of the host machine, volumes are completely managed by Docker.\\n\\n데이터를 유지하기 위한 기본 메커니즘이라고 합니다. `Bind mount`라는 운영 체제의 파일 시스템을 컨테이너에 마운트 해 쓰는 기능이 있는데, 볼륨은 그 보다 더 폭넓은 기능을 제공하고, 관리를 도커 내에서 하기 때문에 도커를 실행하는 운영체제에 영향을 받지 않는다는 장점이 있습니다.\\n\\n### 볼륨 확인\\n\\n먼저 기본으로 생성되는 볼륨을 확인해 보겠습니다.\\n\\n```shell\\n$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=1234 -d mysql\\ne94b0ab7eed5b1d147147ffe5b170d1520ee680f7b3ab7511e4e0fb4fb9a1925\\n\\n$  docker volume list\\nDRIVER    VOLUME NAME\\nlocal     b97c5432ff0a86802d2cbca69484448f1ecd5c530ddcad7e4b7eea3c6ec2e8c5\\n```\\n\\n`docker volume list`로 볼륨의 리스트를 확인하면 임의의 해시로 설정된 볼륨이 생성된 것을 확인할 수 있습니다.\\n그럼 컨테이너를 삭제하고 다시 실행해 보겠습니다.\\n\\n```shell\\n$ docker stop mysql\\nmysql\\n\\n$ docker rm mysql\\nmysql\\n\\n$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=1234 -d mysql\\n456be35825bc8b1b7d2a4494c8b160ab578730f31a625a775abea271b036eae7\\n\\n$ docker volume list\\nDRIVER    VOLUME NAME\\nlocal     6765f342d98d3f274a0d7c3b137e07e48e9c153764e372707b6d987018498e6d\\nlocal     b97c5432ff0a86802d2cbca69484448f1ecd5c530ddcad7e4b7eea3c6ec2e8c5\\n```\\n\\n아까 생성됐던 볼륨은 지워지지 않고 새로운 볼륨이 생성된 것을 확인할 수 있습니다. 지금은 볼륨 리스트로만 확인해봤지만 직접 컨테이너 안에 들어가서 데이터를 생성해보며 테스트를 해봐도 컨테이너를 삭제 후 생성하면 기존의 데이터가 없음을 확인할 수 있습니다.\\n\\n### 볼륨에 이름 부여하기\\n\\n컨테이너를 실행할 때 `-v {볼륨 이름||로컬 경로}:{컨테이너 안 경로}`또는 `--volume={볼륨 이름||로컬 경로}:{컨테이너 안 경로}` 옵션을 부여하여 볼륨을 직접 설정할 수 있습니다. mysql 이미지 안에서 볼륨은 `/var/lib/mysql`에 마운트 되어야 하기 때문에, 해당 경로와 임의의 이름으로 옵션을 부여합니다. 아래에서는 이름을 `mysql-volume`으로 설정했습니다.\\n\\n```shell\\n$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=1234 -v mysql-volume:/var/lib/mysql -d mysql\\n```\\n\\n`myslq-volume`이라는 이름의 볼륨을 `mysql`이라는 이름의 컨테이너에 쓰기로 했으니, 이제 다시 볼륨 목록을 확인해 보겠습니다.\\n\\n```shell\\n$ docker volume list\\nDRIVER    VOLUME NAME\\nlocal     6765f342d98d3f274a0d7c3b137e07e48e9c153764e372707b6d987018498e6d\\nlocal     b97c5432ff0a86802d2cbca69484448f1ecd5c530ddcad7e4b7eea3c6ec2e8c5\\nlocal     mysql-volume\\n```\\n\\n볼륨이 생성되었습니다. 이제 이름이 존재하는 볼륨을 사용하니까, 컨테이너를 계속 삭제해도 볼륨을 직접 제거하지 않는 한 볼륨 옵션을 명시하여 동일한 볼륨을 계속 쓸 수 있습니다.\\n\\n### 볼륨 삭제하기\\n\\n불필요한 볼륨들은 삭제합시다.\\n\\n1. 컨테이너를 삭제할 때 같이 삭제하는 방법으로, 컨테이너 삭제 명령에 `-v`옵션을 줄 수 있습니다.\\n\\n```shell\\n$ docker rm -v mysql\\n```\\n\\n2. 위에서 했던 것과 같이 볼륨 리스트를 보고 직접 해시네임을 선택해 삭제할 수도 있습니다.\\n\\n```shell\\n$ docker volume rm 6765f342d98d3f274a0d7c3b137e07e48e9c153764e372707b6d987018498e6d\\n```\\n\\n3. 로컬에 생성되어있고 컨테이너에 연결되지 않은(==dangling상태의) 모든 볼륨을 다 삭제하는 명령어도 있습니다.\\n\\n```shell\\n$ docker volume prune\\n```\\n\\n---\\n\\n시리즈의 다음 글에서는, 로컬에서 사용하던 데이터 베이스를 그대로 사용하기 위해서 dump파일을 database에 밀어넣는 방법을 알아보겠습니다.\\n\"},\"hasThumbnail\":false}],[\"$\",\"$Lb\",\"1\",{\"post\":{\"slug\":\"mysql-dockerize\",\"meta\":{\"title\":\"mysql dockerize(1) - 도커로 mysql container 띄우기\",\"date\":\"2021/11/07\",\"description\":\"내 로컬 환경은 소중하니까\",\"tags\":[\"MYSQL_ALLOW_EMPTY_PASSWORD\",\"MYSQL_RANDOM_ROOT_PASSWORD\",\"MYSQL_ROOT_PASSWORD\",\"container\",\"docker\",\"mysql\"],\"thumbnail\":\"assets/images/posts/mysql-dockerize.jpeg\"},\"content\":\"\\n최근 작업 중 DB에 스키마 변경을 가하면 DB랑 로컬 개발 환경이 함께 쭉 드러누워버리는 일이 자주 발생합니다. 로컬에서 돌리고 있던 mysql을 격리시켜버리기로 결심했습니다.\\n\\n## 시작점\\n\\n저는 DB로 mysql을 쓰고있고, ROR로 프로젝트를 진행하고 있습니다. 로컬 환경에 mysql server를 설치해 쓰고있었고, Docker는 이미 깔려있습니다.\\n\\n## 도커로 mysql container 띄우기\\n\\n### mysql 이미지 가져오기\\n\\n먼저 mysql 이미지를 가져옵니다.\\n\\n```shell\\n$ docker pull mysql\\n\\nUsing default tag: latest\\nlatest: Pulling from library/mysql\\n...\\n...\\nDigest: ...\\nStatus: Downloaded newer image for mysql:latest\\ndocker.io/library/mysql:latest\\n```\\n\\nlts버젼의 mysql 이미지가 로드됩니다.\\n\\n### mysql 이미지를 컨테이너로 실행하기\\n\\n로드한 이미지를 컨테이너로 실행해봅니다.\\n\\n```shell\\n$ docker run mysql\\n\\n2021-11-07 07:55:25+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 8.0.27-1debian10 started.\\n2021-11-07 07:55:25+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'\\n2021-11-07 07:55:25+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 8.0.27-1debian10 started.\\n2021-11-07 07:55:25+00:00 [ERROR] [Entrypoint]: Database is uninitialized and password option is not specified\\n    You need to specify one of the following:\\n    - MYSQL_ROOT_PASSWORD\\n    - MYSQL_ALLOW_EMPTY_PASSWORD\\n    - MYSQL_RANDOM_ROOT_PASSWORD\\n```\\n\\n에러가 뜹니다. mysql 컨테이너는 root 유저의 password를 어떻게 할 것인지에 대해 옵션을 명시해야 한다고 합니다. 아래 3개의 항목 중 하나를 선택해 컨테이너 안에 환경변수로 넘겨 줍니다.\\n\\n```shell\\n$ docker run mysql -e MYSQL_ROOT_PASSWORD=1234\\n# 또는\\n$ docker run mysql -e MYSQL_ALLOW_EMPTY_PASSWORD=abcd\\n# 또는\\n$ docker run mysql -e MYSQL_RANDOM_ROOT_PASSWORD=abcd\\n```\\n\\n저는 root password를 지정해주었습니다. password를 설정하지 않는 `MYSQL_ALLOW_EMPTY_PASSWORD` 옵션이나 `MYSQL_RANDOM_ROOT_PASSWORD` 옵션도 환경변수 안에 어떤 값이든 담아주어야 동작합니다. 실제로 해당 값이 영향을 끼치지는 않습니다.\\n\\nrandom 옵션은 아래와 같이 실행 로그에서 비밀번호를 알려줍니다.\\n\\n```shell\\n2021-11-07 07:55:40+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 8.0.27-1debian10 started.\\n2021-11-07 07:55:40+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'\\n...\\n...\\n2021-11-07 07:55:48+00:00 [Note] [Entrypoint]: GENERATED ROOT PASSWORD: ojai1toovee3jahC4ooh7on8ahjoo0ji\\n...\\n2021-11-07 07:55:50+00:00 [Note] [Entrypoint]: MySQL init process done. Ready for start up.\\n...\\n2021-11-07T07:55:51.690474Z 0 [System] [MY-011323] [Server] X Plugin ready for connections. Bind-address: '::' port: 33060, socket: /var/run/mysqld/mysqlx.sock\\n2021-11-07T07:55:51.690582Z 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: '8.0.27'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  MySQL Community Server - GPL.\\n```\\n\\n컨테이너가 잘 떴는지 확인해봅니다.\\n\\n```shell\\n$ docker ps\\n\\nCONTAINER ID   IMAGE      COMMAND                  CREATED         STATUS          PORTS                    NAMES\\nddb780457980   mysql      \\\"docker-entrypoint.s…\\\"   4 minutes ago   Up 4 minutes    3306/tcp, 33060/tcp      musing_dewdney\\n```\\n\\n### 컨테이너 실행 결과 확인하기\\n\\n터미널 창을 하나 더 켜고, 아래 명령어로 방금 띄운 mysql 컨테이너에 접속해 볼 수 있습니다. 지정한 비밀번호로 mysql 클라이언트도 잘 접속이 됩니다.\\n\\n```shell\\n$ docker exec -it musing_dewdney bash\\n\\nroot@ddb780457980:/# mysql -uroot -p1234\\n\\nmysql: [Warning] Using a password on the command line interface can be insecure.\\nWelcome to the MySQL monitor.  Commands end with ; or \\\\g.\\nYour MySQL connection id is 9\\nServer version: 8.0.27 MySQL Community Server - GPL\\n\\nCopyright (c) 2000, 2021, Oracle and/or its affiliates.\\n\\nOracle is a registered trademark of Oracle Corporation and/or its\\naffiliates. Other names may be trademarks of their respective\\nowners.\\n\\nType 'help;' or '\\\\h' for help. Type '\\\\c' to clear the current input statement.\\n\\nmysql\u003e\\n```\\n\\n### 옵션 추가\\n\\nmysql 서버는 항상 돌아가고 있어야 하므로 데몬 환경으로 실행하는 것이 일반적입니다. 그리고 편하게 접근하기 위해서 임의로 컨테이너에 네임도 붙이고 싶습니다.\\n띄워놓은 컨테이너를 정지, 삭제 하고 몇가지 옵션을 추가해 새로 띄워봅니다.\\n\\n```shell\\n$ docker kill musing_dewdney\\n\\n$ docker rm musing_dewdney\\n\\n$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=1234 -d mysql\\n```\\n\\n성공하였다면 아까와 같이 컨테이너 안에 접속하여 확인할 수 있습니다.\\n\\n```\\n$ docker exec -it mysql bash\\n```\\n\"},\"hasThumbnail\":false}]]}]],null],\"segment\":\"__PAGE__?{\\\"tag\\\":\\\"container\\\"}\"},\"styles\":[]}],\"segment\":[\"tag\",\"container\",\"d\"]},\"styles\":[]}],\"segment\":\"tags\"},\"styles\":[]}],\"params\":{}}],null]}]]\n"])</script><script>self.__next_f.push([1,"7:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],null,null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,null]\n4:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],null,null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,nu"])</script><script>self.__next_f.push([1,"ll,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]],[],null]]\n"])</script></body></html>
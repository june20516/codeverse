1:HL["/_next/static/css/9674fbd74573baf2.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["slug","rds-dump","d"],{"children":["__PAGE__?{\"slug\":\"rds-dump\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/9674fbd74573baf2.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/b6fa3031163450cc.css",{"as":"style"}]
5:I{"id":"1616","chunks":["771:static/chunks/771-b8a669428e8b47ba.js","274:static/chunks/274-31a5843dc341abd2.js","964:static/chunks/964-3fbb84800944960d.js","925:static/chunks/925-98b9640d621f887a.js","222:static/chunks/222-8be30348cbe4dffe.js","185:static/chunks/app/layout-6cdfa5accf696248.js"],"name":"","async":false}
6:I{"id":"4463","chunks":["272:static/chunks/webpack-300c82a1a1405294.js","667:static/chunks/2443530c-b37977cb0d35fe50.js","488:static/chunks/488-754b8491efac4835.js"],"name":"","async":false}
7:I{"id":"1010","chunks":["272:static/chunks/webpack-300c82a1a1405294.js","667:static/chunks/2443530c-b37977cb0d35fe50.js","488:static/chunks/488-754b8491efac4835.js"],"name":"","async":false}
2:[["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[[null,["$","div",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["slug","rds-dump","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L8",null],"segment":"__PAGE__?{\"slug\":\"rds-dump\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/b6fa3031163450cc.css","precedence":"next"}]]}]}]],null],"segment":["slug","rds-dump","d"]},"styles":[]}],"segment":"posts"},"styles":[]}],"params":{}}],null]
3:[[["$","meta",null,{"charSet":"utf-8"}],null,null,null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]],[],null]]
9:I{"id":"3677","chunks":["771:static/chunks/771-b8a669428e8b47ba.js","964:static/chunks/964-3fbb84800944960d.js","333:static/chunks/app/posts/[slug]/page-a866616cf3028d85.js"],"name":"","async":false}
8:[null,["$","$L9",null,{"post":{"slug":"rds-dump","meta":{"title":"AWS RDS의 Data base를 dump하기","description":"VPC 안에 있는 RDS에서 Data base를 dump해 와서 local의 mysql에 밀어 넣는 과정에서 단편적으로 맞닥뜨렸던 문제를 기록합니다.","date":"2021/09/14","tags":["COLUMN_STATISTICS","NO_AUTO_CREATE_USER","column-statistics=0","mysqldump","sed","sql_mode","ssh tunneling"],"thumbnail":"assets/images/posts/rds-dump.png"},"content":"\n## ssh tunneling을 통해 DB dump해오기\n\n- `mysqldump` 명령어를 통해 `.sql`파일의 형태로 db를 덤프해 올 수 있습니다.\n- tunneling을 수행할 ec2 인스턴스가 mysql client를 가지고 있어야 합니다.\n\n```shell\n$ ssh `tunneling-instanse-username`@`tunneling-instanse-host` -i `key-file-path` mysqldump -u`username` -p`password` -h `remote-db-host` `database-name` > `local/path/to/save.sql`\n```\n\n### COLUMN_STATISTICS\n\n#### 덤프 시도 중 `...: Unknown table 'COLUMN_STATISTICS' in information_schema` 라는 에러가 발생할 경우\n\n- 8.0부터 새로 추가된 옵션으로, 덤프 할 때 ANALYZE TABLE에 통계 데이터를 입력 또는 수정하는 옵션이라고 합니다.<sup>[레퍼런스](https://jay-ji.tistory.com/62)</sup>\n- 명시적으로 해당 옵션을 사용하지 않는다고 알려줍시다. dump 명령에 `--column-statistics=0` 옵션을 추가합니다.\n\n```shell\n$ ssh `tunneling-instanse-username`@`tunneling-instanse-host` -i `key-file-path` mysqldump -u`username` -p`password` -h `remote-db-host` --column-statistics=0 `database-name` > `local/path/to/save.sql`\n```\n\n#### 덤프 시도 중 `...unknown variable 'column-statistics=0'...` 라는 에러가 발생할 경우\n\n- 위의 문제에 해당하지 않는 데 옵션을 주는 경우로, dump 명령 옵션에서 `--column-statistics=0`을 제거합니다.\n\n## .sql파일을 로컬 mysql에 로드하기\n\n- `mysql`명령어를 통해 `database-name`이라는 data base 에 `dumped.sql` 파일의 내용을 로드할 수 있습니다.\n- 데이터를 받을 database는 미리 생성되어있고 비어있어야 합니다.\n\n```shell\n$ mysql -u`local-user-name` -p`local-pwd` `database-name` < `path/for/dumped.sql`\n```\n\n### NO_AUTO_CREATE_USER\n\n#### 로드 시도 중 `Variable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'` 라는 에러가 발생할 경우\n\n- USER 생성과 관련있는 모드입니다. mysql 8.0 이상부터 해당 모드가 제거되고 별도 구문으로(`CREAT USER...` 또는 `GRANT...` ) 처리됩니다.\n- 해결을 위해 `dumped.sql` 의 내용을 약간 수정해줍니다.\n- `.sql`파일은 데이터 베이스를 구성하는 sql문이 잔뜩 적혀있어 용량이 매우 큰 경우가 대부분입니다. 따라서 editor으로 열어서 수정하는 것은 좋지 않은 선택입니다. `sed` 명령어를 사용해 수정합니다.\n- `sed`명령어는 레퍼런스가 많지만, Unix 계열인 mac의 터미널에서는 용법이 조금 다릅니다.\n\n```shell\nsed -i '' 's/NO_AUTO_CREATE_USER//' `path/for/dumped.sql`\n```\n\n- 위와 같이 입력하여 sql파일을 수정하고 다시 로드합니다.\n"},"meta":{"title":"AWS RDS의 Data base를 dump하기","description":"VPC 안에 있는 RDS에서 Data base를 dump해 와서 local의 mysql에 밀어 넣는 과정에서 단편적으로 맞닥뜨렸던 문제를 기록합니다.","date":"2021/09/14","tags":["COLUMN_STATISTICS","NO_AUTO_CREATE_USER","column-statistics=0","mysqldump","sed","sql_mode","ssh tunneling"],"thumbnail":"assets/images/posts/rds-dump.png"},"content":"<h2 id=\"ssh-tunneling을-통해-db-dump해오기\" class=\"heading\">ssh tunneling을 통해 DB dump해오기</h2>\n<ul>\n<li><code>mysqldump</code> 명령어를 통해 <code>.sql</code>파일의 형태로 db를 덤프해 올 수 있습니다.</li>\n<li>tunneling을 수행할 ec2 인스턴스가 mysql client를 가지고 있어야 합니다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">ssh</span> <span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-username<span class=\"token variable\">`</span></span>@<span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-host<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-i</span> <span class=\"token variable\"><span class=\"token variable\">`</span>key-file-path<span class=\"token variable\">`</span></span> mysqldump -u<span class=\"token variable\"><span class=\"token variable\">`</span>username<span class=\"token variable\">`</span></span> -p<span class=\"token variable\"><span class=\"token variable\">`</span>password<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-h</span> <span class=\"token variable\"><span class=\"token variable\">`</span>remote-db-host<span class=\"token variable\">`</span></span> <span class=\"token variable\"><span class=\"token variable\">`</span>database-name<span class=\"token variable\">`</span></span> <span class=\"token operator\">></span> <span class=\"token variable\"><span class=\"token variable\">`</span>local/path/to/save.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<h3 id=\"column_statistics\">COLUMN_STATISTICS</h3>\n<h4 id=\"덤프-시도-중--unknown-table-column_statistics-in-information_schema-라는-에러가-발생할-경우\">덤프 시도 중 <code>...: Unknown table 'COLUMN_STATISTICS' in information_schema</code> 라는 에러가 발생할 경우</h4>\n<ul>\n<li>8.0부터 새로 추가된 옵션으로, 덤프 할 때 ANALYZE TABLE에 통계 데이터를 입력 또는 수정하는 옵션이라고 합니다.<sup><a href=\"https://jay-ji.tistory.com/62\" target=\"_blank\" rel=\"noopener noreferer\">레퍼런스</a></sup></li>\n<li>명시적으로 해당 옵션을 사용하지 않는다고 알려줍시다. dump 명령에 <code>--column-statistics=0</code> 옵션을 추가합니다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">ssh</span> <span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-username<span class=\"token variable\">`</span></span>@<span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-host<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-i</span> <span class=\"token variable\"><span class=\"token variable\">`</span>key-file-path<span class=\"token variable\">`</span></span> mysqldump -u<span class=\"token variable\"><span class=\"token variable\">`</span>username<span class=\"token variable\">`</span></span> -p<span class=\"token variable\"><span class=\"token variable\">`</span>password<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-h</span> <span class=\"token variable\"><span class=\"token variable\">`</span>remote-db-host<span class=\"token variable\">`</span></span> --column-statistics<span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token variable\"><span class=\"token variable\">`</span>database-name<span class=\"token variable\">`</span></span> <span class=\"token operator\">></span> <span class=\"token variable\"><span class=\"token variable\">`</span>local/path/to/save.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<h4 id=\"덤프-시도-중-unknown-variable-column-statistics0-라는-에러가-발생할-경우\">덤프 시도 중 <code>...unknown variable 'column-statistics=0'...</code> 라는 에러가 발생할 경우</h4>\n<ul>\n<li>위의 문제에 해당하지 않는 데 옵션을 주는 경우로, dump 명령 옵션에서 <code>--column-statistics=0</code>을 제거합니다.</li>\n</ul>\n<h2 id=\"sql파일을-로컬-mysql에-로드하기\" class=\"heading\">.sql파일을 로컬 mysql에 로드하기</h2>\n<ul>\n<li><code>mysql</code>명령어를 통해 <code>database-name</code>이라는 data base 에 <code>dumped.sql</code> 파일의 내용을 로드할 수 있습니다.</li>\n<li>데이터를 받을 database는 미리 생성되어있고 비어있어야 합니다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ mysql -u<span class=\"token variable\"><span class=\"token variable\">`</span>local-user-name<span class=\"token variable\">`</span></span> -p<span class=\"token variable\"><span class=\"token variable\">`</span>local-pwd<span class=\"token variable\">`</span></span> <span class=\"token variable\"><span class=\"token variable\">`</span>database-name<span class=\"token variable\">`</span></span> <span class=\"token operator\">&#x3C;</span> <span class=\"token variable\"><span class=\"token variable\">`</span>path/for/dumped.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<h3 id=\"no_auto_create_user\">NO_AUTO_CREATE_USER</h3>\n<h4 id=\"로드-시도-중-variable-sql_mode-cant-be-set-to-the-value-of-no_auto_create_user-라는-에러가-발생할-경우\">로드 시도 중 <code>Variable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'</code> 라는 에러가 발생할 경우</h4>\n<ul>\n<li>USER 생성과 관련있는 모드입니다. mysql 8.0 이상부터 해당 모드가 제거되고 별도 구문으로(<code>CREAT USER...</code> 또는 <code>GRANT...</code> ) 처리됩니다.</li>\n<li>해결을 위해 <code>dumped.sql</code> 의 내용을 약간 수정해줍니다.</li>\n<li><code>.sql</code>파일은 데이터 베이스를 구성하는 sql문이 잔뜩 적혀있어 용량이 매우 큰 경우가 대부분입니다. 따라서 editor으로 열어서 수정하는 것은 좋지 않은 선택입니다. <code>sed</code> 명령어를 사용해 수정합니다.</li>\n<li><code>sed</code>명령어는 레퍼런스가 많지만, Unix 계열인 mac의 터미널에서는 용법이 조금 다릅니다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\"><span class=\"token function\">sed</span> <span class=\"token parameter variable\">-i</span> <span class=\"token string\">''</span> <span class=\"token string\">'s/NO_AUTO_CREATE_USER//'</span> <span class=\"token variable\"><span class=\"token variable\">`</span>path/for/dumped.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<ul>\n<li>위와 같이 입력하여 sql파일을 수정하고 다시 로드합니다.</li>\n</ul>"}]]
